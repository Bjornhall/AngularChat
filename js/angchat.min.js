var AngChatClient=angular.module("AngChat",["ngRoute"]);AngChatClient.config(function(a){a.when("/login",{templateUrl:"views/login.html",controller:"LoginController"}).when("/rooms/:user/",{templateUrl:"views/rooms.html",controller:"RoomsController"}).when("/room/:user/:room/",{templateUrl:"views/room.html",controller:"RoomController"}).otherwise({redirectTo:"/login"})}),angular.module("AngChat").controller("LoginController",["$scope","$location","$rootScope","$routeParams","socket",function(a,b,c,d,e){c.showRoomList=!1,c.inRoom=!1,a.errorMessage="",a.nickname="",a.login=function(){""===a.nickname?a.errorMessage="Please choose a nickname!":e.emit("adduser",a.nickname,function(d){d?(b.path("/rooms/"+a.nickname),c.showRoomList=!0):a.errorMessage="Unfortunately this nick is taken!. Please choose another nickname"})}}]),angular.module("AngChat").controller("RoomController",["$scope","$location","$rootScope","$routeParams","socket",function(a,b,c,d,e){a.currentRoom=d.room,a.currentUser=d.user,a.currentUsers=[],a.currentOps=[],a.errorMessage="",a.successMessage="",a.messages=[],a.message="",a.isOp=!1,a.showP=!1,a.pMessage="",a.pMessages=[],a.pUser="",a.pw1="",a.pw2="";var f=!1;c.inRoom=!0;var g={room:a.currentRoom,insideRoom:!0};c.isPassword&&(g.pass=c.roomPassword),e.emit("joinroom",g,function(a){a&&(c.roomPassword="",c.isPassword=!1,c.inRoom=!0)}),e.on("updateusers",function(b,c,d){b===a.currentRoom&&(a.currentUsers=c,a.currentOps=d,void 0!==a.currentOps[a.currentUser]&&(a.isOp=!0))}),e.on("updatechat",function(b,c){b===a.currentRoom&&(a.messages=c)}),e.on("kicked",function(d,e){a.currentUser===e&&a.currentRoom===d&&(c.roomErrorMessage="You got kicked!",c.roomErrorMessage="You got banned from that room!",c.inRoom=!1,b.path("/rooms/"+a.currentUser))}),e.on("banned",function(d,e){a.currentUser===e&&a.currentRoom===d&&(c.roomErrorMessage="You got banned from that room!",setTimeout(function(){c.roomErrorMessage=""},3e3),c.inRoom=!1,b.path("/rooms/"+a.currentUser))}),e.on("opped",function(b,c,d){a.currentUser===c&&a.currentRoom===b?(a.isOp=!0,a.successMessage="You got opped by "+d,setTimeout(function(){a.successMessage=""},3e3)):setTimeout(function(){a.errorMessage=""},3e3)}),e.on("deopped",function(b,c,d){a.currentUser===c&&a.currentRoom===b?(a.isOp=!1,a.errorMessage=d+" took away your op rights!",setTimeout(function(){a.errorMessage=""},3e3)):setTimeout(function(){a.errorMessage=""},3e3)}),a.sendmsg=function(){e.emit("sendmsg",{roomName:a.currentRoom,msg:a.message}),a.message=""},a.showPmessage=function(b){f||(h(),f=!0),a.pUser=b,a.showP=!0},a.sendPrivateMessage=function(){var b={nick:a.pUser,message:a.pMessage};e.emit("privatemsg",b),a.pMessage=""},e.on("recv_privatemsg",function(b,c){var d={from:b,to:a.currentUser,msg:c};a.pMessages.push(d),f||(h(),f=!0)}),a.closePrivateMsgSidebar=function(){h(),f=!1},a.partroom=function(){if(c.inRoom=!1,void 0!==a.currentOps[a.currentUser]&&1===Object.keys(a.currentOps).length){for(var f in a.currentUsers){e.emit("op",{user:a.currentUsers[f],room:a.currentRoom},function(a){});break}a.isOp=!1}e.emit("partroom",d.room),b.path("/rooms/"+a.currentUser)},a.kick=function(b){e.emit("kick",{user:b,room:a.currentRoom},function(c){c?(a.successMessage="You just kicked "+b+" out of this room!",setTimeout(function(){a.successMessage=""},3e3)):(a.errorMessage="For some reason you were not able to kick "+b+" out!",setTimeout(function(){a.errorMessage=""},3e3))})},a.ban=function(b){e.emit("ban",{user:b,room:a.currentRoom},function(c){c?(a.successMessage="You just banned "+b+" from this room!",setTimeout(function(){a.successMessage=""},3e3)):(a.errorMessage="For some reason you were not able to ban "+b+" from this room!",setTimeout(function(){a.errorMessage=""},3e3))})},a.op=function(b){e.emit("op",{user:b,room:a.currentRoom},function(c){c?(a.successMessage="You just opped "+b,setTimeout(function(){a.successMessage=""},3e3)):(a.errorMessage="For some reason you could not give op to "+b,setTimeout(function(){a.errorMessage=""},3e3))})},a.deop=function(b){a.currentUser!==b?e.emit("deop",{user:b,room:a.currentRoom},function(c){c?(a.successMessage="You just de-opped "+b,setTimeout(function(){a.successMessage=""},3e3)):(a.errorMessage="For some reason you could not de-op "+b,setTimeout(function(){a.errorMessage=""},3e3))}):a.errorMessage="Please do not try to de-op yourself!"},a.pw=function(){void 0!==a.currentOps[a.currentUser]&&a.pw1===a.pw2&&a.pw1.length>=6&&e.emit("setpassword",{room:a.currentRoom,password:a.pw1},function(b){b?(c.isPassword=!0,a.show_password_form=!1,a.successMessage="A new password has been set for this room!",setTimeout(function(){a.successMessage=""},3e3)):(a.errorMessage="Oops.. something went wrong. Not able to set password.",setTimeout(function(){a.errorMessage=""},3e3))})},a.rmpw=function(){void 0!==a.currentOps[a.currentUser]&&e.emit("removepassword",{room:a.currentRoom},function(b){b?(c.isPassword=!1,a.successMessage="Password removed!",setTimeout(function(){a.successMessage=""},3e3)):(a.errorMessage="Dang it! Looks like we still have a password!",setTimeout(function(){a.errorMessage=""},3e3))})},a.show_password=function(){a.show_password_form=!0};var h=function(){var a=["reveal","top","boring","perspective","extra-pop"],b="linear";return $.inArray(b,a)>-1?($("body").removeClass(),$("body").addClass(b)):($("body").removeClass(),$("#site-canvas").removeClass(),$("#site-canvas").addClass(b)),$("#site-wrapper").toggleClass("show-nav"),!1}}]),angular.module("AngChat").controller("RoomsController",["$scope","$location","$rootScope","$routeParams","socket",function(a,b,c,d,e){function f(b){for(var c=0;c<a.rooms.length;c++)if(a.rooms[c]===b)return!0;return!1}c.showRoomList=!0,c.isPassword=!1,c.roomPassword="",c.roomErrorMessage="",a.roomName="",a.currentUser=d.user,a.rooms=[],a.errorMessage="",a.accessRoom="",c.inRoom=!1,e.emit("rooms"),e.on("roomlist",function(b){for(var c in b)f(c)||a.rooms.push(c)}),a.joinRoom=function(d,f){var g={room:d,insideRoom:!1};c.isPassword&&(g.pass=f,c.roomPassword=f),e.emit("joinroom",g,function(e,f){e?(a.isPassword=!1,b.path("/room/"+a.currentUser+"/"+d)):"banned"===f?a.errorMessage="You've been banned from "+d:"wrong password"===f&&(c.isPassword=!0,a.accessRoom=d)})},a.createRoom=function(){b.path("/room/"+a.currentUser+"/"+a.roomName)}}]),$(document).ready(function(){console.log("document ready"),$(function(){var a=["reveal","top","boring","perspective","extra-pop"];$("#test_id").click(function(){console.log("clicked on user Sidebar Demo");var b=$(this).data("transition");return $.inArray(b,a)>-1?($("body").removeClass(),$("body").addClass(b)):($("body").removeClass(),$("#site-canvas").removeClass(),$("#site-canvas").addClass(b)),$("#site-wrapper").toggleClass("show-nav"),!1})})});